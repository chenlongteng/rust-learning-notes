# 实用工具特征
熟悉这些常见特征，才能写出符合Rust语言惯例的代码并据此为你的crate设计公共接口，让用户认为这些接口是符合Rust风格的。

特征 | 描述
--- | ---
Drop | 析构器。每当丢弃一个值时，Rust都要自动运行的清理代码
Sized | 具有在编译器已知的固定大小类型的标记特征，与之相对的是动态大小类型(如切片)
Clone | 用来支持克隆值的特征
Copy | 可以简单地通过对包含值内存进行逐字节复制以进行克隆的类型的标记特征
Deref与DerefMut | 只能指针类型的特征
Default | 具有合理“默认值”的类型
AsRef与AsMut | 用于从另一种类型中借入一种引用类型的转换特征
Borrow与BorrowMut | 转换特征，类似AsRef/AsMut，但能额外保证一致的哈希、排序和相等性
From与Into | 用于将一种类型的值转换为另一种类型的转换特征
TryFrom与TryInto | 用于将一种类型的值转换为另一种类型的转换特征，用于可能失败的转换
ToOwned | 用于将引用转换为拥有型值的转换特征

另还有Iterator/IntoIterator，Hash，Send/Sync等特征，其他文件中介绍

## Drop
```rust
trait Drop{
    fn drop(&mut self);
}
```
当一个值的拥有者消失时，Rust会丢弃该值。丢弃一个值就必须释放该值拥有的任何其他值、堆存储好系统资源。  
丢弃可能发生在多种情况下：  
1. 变量超出作用域
2. 在表达式语句的末尾
3. 当截断一个向量时，会从其末尾移除元素  

etc  

大多数情况下，Rust会自动处理丢弃值的工作。  
也可以通过实现std::ops::Drop特征来自定义Rust该如何丢弃此类型的值。  
若定义了std::ops::Drop，那么Rust就会先调用Drop::drop方法，再像往常一样继续丢弃它的字段或元素拥有的任何值。  
由于Drop::drop先调用，所以drop方法里也能随意使用拥有字段。  
一个类型实现了Drop特征，就不能在实现Copy特征了。  

标准库还定义了一个drop函数(非Drop特征中的成员):
```rust
fn drop<T>(_x :T) {}
```
非常简单，传入任意值，然后什么也不做。以为值的所有权移动到drop里，drop函数结束超出值的作用域则触发丢弃  


## Sized
`固定大小类型` 是指其每个值在内存中都有相同大小的类型。
Rust自动为所有适用的类型事项了std::marker::Sized特征。Sized的唯一用途是作为类型变量的限界。

`无固定大小类型` 如`[T]`切片就是不固定大小的，字符串字面量`&str`中的`str`也是不固定大小，但是`&str`对不固定的`str`切片的引用是固定大小的。另一种就是`dyn`类型，它是特征对象的引用目标，对应的用`&dyn trait`和`Box<dyn trait>`指向实现了trait特征的某个值的指针。  

Rust不能将无固定大小的值存储在变量中或将它们作为参数传递。只能通过像&str或Box<dyn trait>这样的本身是固定大小的指针来处理它们。指向无固定大小的指针始终是一个`胖指针`，宽度为`两个机器字`：指向切片的指针带有切片的长度，特征对象带有指向方法实现的虚表的指针。  

`Sized`已经成为Rust中的隐式默认值，若不需要，需显示指出`T : ?Sized`  

第三种无固定大小类型是结构体的最后一个字段且只能是最后一个可以是无固定大小的，这样结构体也会是无固定大小。如`Rc<T>`引用计数指针的内部实现是指向私有类型`RcBox<T>`:
```rust
struct RcBox<T: ?Sized> {
    ref_count: usize,
    value: T,
}
```
## Clone
